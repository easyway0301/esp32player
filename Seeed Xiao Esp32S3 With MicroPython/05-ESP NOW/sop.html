<meta charset="UTF-8">
<title>XIAO ESP32-S3 ESPâ€‘NOW é€šè¨Šæ•™å­¸</title>

<style>
    body {
        font-family: Arial, "Microsoft JhengHei", sans-serif;
        line-height: 1.9;
        max-width: 980px;
        margin: 40px auto;
        padding: 0 20px;
        color: #222;
        background-color: #f5f7fa;
    }

    h1 {
        text-align: center;
        margin-bottom: 10px;
    }

    .subtitle {
        text-align: center;
        color: #555;
        margin-bottom: 50px;
    }

    section {
        background: #ffffff;
        border-radius: 14px;
        padding: 40px;
        margin-bottom: 50px;
        box-shadow: 0 8px 24px rgba(0,0,0,0.08);
    }

    h2 {
        margin-top: 0;
        border-left: 6px solid #4CAF50;
        padding-left: 14px;
    }

    p {
        margin: 14px 0;
    }

    ul {
        margin-left: 22px;
    }

    img {
        width: 100%;
        max-width: 100%;
        height: auto;
        display: block;
        margin: 28px auto 10px;
        border-radius: 12px;
        box-shadow: 0 6px 16px rgba(0,0,0,0.12);
    }


    .highlight {
        background: #e8f5e9;
        border-left: 6px solid #4caf50;
        padding: 16px 20px;
        border-radius: 8px;
        margin: 20px 0;
        font-size: 16px;
    }

    .warning {
        background: #fff3e0;
        border-left: 6px solid #ff9800;
        padding: 16px 20px;
        border-radius: 8px;
        margin: 20px 0;
    }

    /* Code block (GitHub style) */
    .code-block {
        position: relative;
        background: #0d1117;
        color: #c9d1d9;
        border-radius: 12px;
        padding: 20px;
        margin: 30px 0;
        font-family: Consolas, Monaco, monospace;
        font-size: 14px;
        overflow-x: auto;
    }

    .code-block pre {
        margin: 0;
        white-space: pre;
    }

    .copy-btn {
        position: absolute;
        top: 12px;
        right: 12px;
        background: #238636;
        color: white;
        border: none;
        border-radius: 6px;
        padding: 6px 14px;
        cursor: pointer;
        font-size: 13px;
    }

    .copy-btn:hover {
        background: #2ea043;
    }

    a {
        color: #2e7d32;
        font-weight: bold;
        text-decoration: none;
    }

    a:hover {
        text-decoration: underline;
    }
</style>




<h3>XIAO ESP32â€‘S3 ESPâ€‘NOW é€šè¨Šæ•™å­¸</h3>
<div class="subtitle">MicroPython ESPâ€‘NOWï¼ˆé»å°é» / å¤šç¯€é»ï¼‰</div>

<section>
<h2>ğŸ“Œ æ¨¡çµ„ç°¡ä»‹</h2>
<p>
ESPâ€‘NOW æ˜¯ Espressifï¼ˆESP32 / ESP32â€‘S3ï¼‰æ”¯æ´çš„ä½å»¶é²ç„¡ç·šé€šè¨Šå”å®šï¼Œå¯å¯¦ç¾
<strong>ç„¡ Wiâ€‘Fi é…å° / ä½åŠŸè€—é»å°é»æˆ–å»£æ’­</strong>çš„æ•¸æ“šå‚³è¼¸ï¼Œé©åˆç‰©è¯ç¶²æ„Ÿæ¸¬å™¨ã€é™æ§èˆ‡è£ç½®é–“é€šè¨Šã€‚
</p>
<p>
MicroPython å…§å»ºäº†ã€Œespnowã€æ¨¡çµ„ï¼Œå¯ç›´æ¥å»ºç«‹é€šè¨Šï¼Œä¸éœ€ Wiâ€‘Fi é€£ç·šè¨­å®šã€‚</p>
</section>

<section>
<h2>ğŸ”Œ ç¡¬é«”è¦æ±‚</h2>
<ul>
    <li>è‡³å°‘å…©å¡Š XIAO ESP32â€‘S3 é–‹ç™¼æ¿ï¼Œ<span style="color: rgb(31, 35, 40); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, &quot;Noto Sans&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-size: 16px; background-color: rgb(255, 255, 255);">å‹™å¿…è£ä¸Šå¤©ç·šã€‚</span></li>
    <li>USB å‚³è¼¸ç·šå„ä¸€æ¢</li>
</ul>
</section>

<section>
<h2>ğŸ“¦ ä½¿ç”¨å‡½å¼åº«</h2>
<ul>
    <li>network</li>
    <li>espnow</li>
    <li>time</li>
</ul>
</section>

<section>
<h2>ğŸ§ª ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼ˆGetMac.pyï¼‰</h2><div><span style="color: rgb(31, 35, 40); font-family: -apple-system, BlinkMacSystemFont, &quot;Segoe UI&quot;, &quot;Noto Sans&quot;, Helvetica, Arial, sans-serif, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;; font-size: 16px; background-color: rgb(255, 255, 255);">å…ˆåœ¨æ¥æ”¶ç«¯çš„é‚£ç‰‡ESP32åŸ·è¡ŒGetMac.pyï¼Œå–å¾—Macä½å€å¾Œï¼Œå†è²¼åˆ°è¦åšç‚ºç™¼å°„ç«¯çš„é‚£ç‰‡Esp32</span></div>

<div class="code-block">
          <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre>import network
# åŒ¯å…¥ network æ¨¡çµ„ï¼Œç”¨ä¾†æ§åˆ¶ ESP32 çš„ Wi-Fi åŠŸèƒ½

wlan = network.WLAN(network.STA_IF)
# å»ºç«‹ä¸€å€‹ Wi-Fi ç‰©ä»¶ï¼Œä¸¦è¨­å®šç‚ºã€ŒSTAï¼ˆStationï¼Œç”¨æˆ¶ç«¯ï¼‰ã€æ¨¡å¼

wlan.active(True)
# å•Ÿç”¨ Wi-Fiï¼ˆä¸€å®šè¦å…ˆå•Ÿç”¨ï¼Œæ‰èƒ½ä½¿ç”¨ Wi-Fi / ESP-NOW ç­‰åŠŸèƒ½ï¼‰

print(wlan.config('mac'))
# è®€å–ä¸¦å°å‡ºç›®å‰ Wi-Fi ä»‹é¢çš„ MAC ä½å€ï¼ˆbytes æ ¼å¼ï¼‰
# é€™å€‹ MAC ä½å€å¸¸ç”¨åœ¨ ESP-NOW ç•¶ä½œ peer_mac
</pre>
</div>
</section>

<section>
<h2>ğŸ§ª ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼ˆä¸»æ©Ÿï¼šSenderï¼‰</h2>
<div class="code-block">
  <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre>
import network
# åŒ¯å…¥ network æ¨¡çµ„ï¼Œç”¨ä¾†æ§åˆ¶ ESP32 çš„ Wi-Fi åŠŸèƒ½

import espnow
# åŒ¯å…¥ ESP-NOW æ¨¡çµ„ï¼Œç”¨ä¾†åš ESP32 ä¹‹é–“çš„ç„¡ç·šé»å°é»é€šè¨Š

import time
# åŒ¯å…¥ time æ¨¡çµ„ï¼Œç”¨ä¾†åšå»¶é²ï¼ˆsleepï¼‰

# -------------------------------------------------
# å•Ÿå‹• Wi-Fi STAï¼ˆStationï¼Œç”¨æˆ¶ç«¯ï¼‰æ¨¡å¼
# -------------------------------------------------
sta = network.WLAN(network.STA_IF)
# å»ºç«‹ Wi-Fi ç‰©ä»¶ï¼Œè¨­å®šç‚º STA æ¨¡å¼ï¼ˆESP-NOW éœ€è¦ï¼‰

sta.active(True)
# å•Ÿç”¨ Wi-Fiï¼ˆä¸éœ€è¦é€£ä¸ŠåŸºåœ°å°ï¼‰

sta.disconnect()
# ä¸­æ–·ä»»ä½•è‡ªå‹•é€£ç·šçš„ Wi-Fi AP
# é¿å…è¢« AP ç¶å®š Channelï¼Œå°è‡´ ESP-NOW æ”¶ä¸åˆ°è³‡æ–™

# -------------------------------------------------
# åˆå§‹åŒ– ESP-NOW
# -------------------------------------------------
espSender = espnow.ESPNow()
# å»ºç«‹ ESP-NOW ç‰©ä»¶

espSender.active(True)
# å•Ÿç”¨ ESP-NOW åŠŸèƒ½

# -------------------------------------------------
# è¨­å®šæ¥æ”¶ç«¯ï¼ˆå°æ–¹ï¼‰ESP32 çš„ MAC ä½å€
# -------------------------------------------------
peer_mac = b'\x90pi\x0b\xe28'
# å°æ–¹ ESP32 çš„ MAC ä½å€ï¼ˆbytes æ ¼å¼ï¼‰
# å¯ç”¨ wlan.config('mac') åœ¨å°æ–¹æ¿å­ä¸ŠæŸ¥è©¢

espSender.add_peer(peer_mac)
# å°‡å°æ–¹åŠ å…¥ ESP-NOW çš„é€šè¨Šå°è±¡ï¼ˆpeerï¼‰

# -------------------------------------------------
# é–‹å§‹å‚³é€è³‡æ–™
# -------------------------------------------------
print("Start sending...")
# é¡¯ç¤ºé–‹å§‹å‚³é€è¨Šæ¯

# -------------------------------------------------
# å‚³é€ã€Œæ‰“é–‹ User LEDã€æŒ‡ä»¤
# -------------------------------------------------
espSender.send(peer_mac, "æ‰“é–‹UserLed".encode("utf-8"))
# å°‡ä¸­æ–‡å­—ä¸²è½‰æˆ UTF-8 bytes å¾Œé€å‡º
# ESP-NOW åªèƒ½å‚³é€ bytes è³‡æ–™

time.sleep(2)
# ç­‰å¾… 2 ç§’ï¼Œè®“æ¥æ”¶ç«¯æœ‰æ™‚é–“è™•ç†ç¬¬ä¸€å€‹æŒ‡ä»¤

# -------------------------------------------------
# å‚³é€ã€Œé—œæ‰ User LEDã€æŒ‡ä»¤
# -------------------------------------------------
espSender.send(peer_mac, "é—œæ‰UserLed".encode("utf-8"))
# å†æ¬¡é€å‡º UTF-8 ç·¨ç¢¼çš„ä¸­æ–‡æŒ‡ä»¤

print("å‚³é€å®Œæˆ")
# å‚³é€å®Œæˆ

</pre>
</div>
</section>

<section>
<h2>ğŸ§ª ç¯„ä¾‹ç¨‹å¼ç¢¼ï¼ˆå¾æ©Ÿï¼šReceiverï¼‰</h2>
<div class="code-block">
  <button class="copy-btn" onclick="copyCode(this)">Copy</button>
<pre># https://easyway0301.github.io/Seeed Xiao Esp32S3 With MicroPython/02-TurnOn UserLed/sop.html
# ä»¥ä¸‹ç‚º02-TurnOn UserLedç¯„ä¾‹
from machine import Pin
import time

# æœ¬ç¯„ä¾‹é©ç”¨Seeed XIAO Esp32S3é–‹ç™¼æ¿
# TYPECæ’é ­æœä¸Šï¼ŒUserLedç‡ˆåœ¨å³é‚Šï¼Œæ‰“é–‹æ˜¯é»ƒç‡ˆã€‚

# è¨­å®š LED è…³ä½
# è²¼ç‰‡å¼LEDç‡ˆç„Šåœ¨GPIO 21 
UserLed = Pin(21, Pin.OUT)

def æ‰“é–‹UserLed():
    print("æ‰“é–‹UserLed")
    # LED äº®ç‡ˆ
    UserLed.value(0)
    #UserLed.off() # æ³¨æ„å¦‚æœè¦ç”¨offï¼Œå®ƒæœƒäº®ç‡ˆ

def é—œæ‰UserLed():
    print("é—œæ‰UserLed")
    # LED ç†„ç‡ˆ
    UserLed.value(1)
    #UserLed.on() # æ³¨æ„å¦‚æœè¦ç”¨onï¼Œå®ƒæœƒé—œç‡ˆ
# ä»¥ä¸Šç‚º02-TurnOn UserLedç¯„ä¾‹

import network
# åŒ¯å…¥ network æ¨¡çµ„ï¼Œç”¨ä¾†æ§åˆ¶ ESP32 çš„ Wi-Fi åŠŸèƒ½

import espnow
# åŒ¯å…¥ ESP-NOW æ¨¡çµ„ï¼Œç”¨ä¾†é€²è¡Œé»å°é»ç„¡ç·šé€šè¨Š

# -------------------------------------------------
# å•Ÿå‹• Wi-Fi STAï¼ˆStationï¼Œç”¨æˆ¶ç«¯ï¼‰æ¨¡å¼
# -------------------------------------------------
sta = network.WLAN(network.STA_IF)
# å»ºç«‹ Wi-Fi ç‰©ä»¶ï¼Œè¨­å®šç‚º STA æ¨¡å¼

sta.active(True)
# å•Ÿç”¨ Wi-Fi åŠŸèƒ½ï¼ˆESP-NOW éœ€è¦ Wi-Fi ä»‹é¢ activeï¼‰

sta.disconnect()
# é¿å…è‡ªå‹•é€£ç·šåˆ° Wi-Fi APï¼Œç¢ºä¿ ESP-NOW æ”¶ç™¼ç©©å®š

# -------------------------------------------------
# åˆå§‹åŒ– ESP-NOW
# -------------------------------------------------
espReceiver = espnow.ESPNow()
# å»ºç«‹ ESP-NOW ç‰©ä»¶

espReceiver.active(True)
# å•Ÿç”¨ ESP-NOW åŠŸèƒ½

# -------------------------------------------------
# ç­‰å¾…æ¥æ”¶è³‡æ–™
# -------------------------------------------------
print("ç­‰å¾…æ¥æ”¶è³‡æ–™...")
while True:
    host, msg = espReceiver.recv()  # é˜»å¡ç­‰å¾…æ¥æ”¶ ESP-NOW è³‡æ–™

    if msg:
        text = msg.decode("utf-8")  # å°‡ bytes è½‰æˆ UTF-8 å­—ä¸²
        # ä¸­æ–‡æŒ‡ä»¤å¿…é ˆ decode æ‰èƒ½æ¯”å°

        if text == "æ‰“é–‹UserLed":
            print("æ”¶åˆ°é–‹ç‡ˆæŒ‡ä»¤")
            æ‰“é–‹UserLed()  # å‘¼å«å‡½å¼é–‹å•Ÿ User LED

        elif text == "é—œæ‰UserLed":
            print("æ”¶åˆ°é—œç‡ˆæŒ‡ä»¤")
            é—œæ‰UserLed()  # å‘¼å«å‡½å¼é—œé–‰ User LED
</pre>
</div>
</section>

<section>
<h2>â–¶ åŸ·è¡Œçµæœ</h2>
<ul>
    <li>Sender ç«¯è¨Šæ¯</li>
    <li>Receiver ç«¯é»äº®Led2ç§’å¾Œç†„æ»…ã€‚</li>
    <li>ç„¡éœ€ Wiâ€‘Fi é…å°å³å¯å‚³è¼¸è³‡æ–™</li>
</ul>
</section>

<section>
<h2>âš  æ³¨æ„äº‹é …</h2>
<ul>
    <li>ESPâ€‘NOW éœ€å•Ÿç”¨ Wiâ€‘Fi ä»‹é¢æ‰å¯é‹ä½œï¼ˆä¸éœ€çœŸæ­£é€£ç¶²ï¼‰ã€‚</li>
    <li>å‚³è¼¸è³‡æ–™å‰éœ€å…ˆåŠ å…¥å°ç­‰è¨­å‚™ MACï¼Œå¦å‰‡æœƒç„¡æ³•é€é”ã€‚</li>
    <li>è‹¥ç„¡æ”¶åˆ°è³‡æ–™ï¼Œè«‹ç¢ºèªå›ºä»¶ç‰ˆæœ¬æ˜¯å¦æ”¯æ´ espnow æ¨¡çµ„ã€‚</li>
</ul>
</section>

<script>
function copyCode(btn) {
    const code = btn.nextElementSibling.innerText;
    navigator.clipboard.writeText(code);
    btn.innerText = "Copied!";
    setTimeout(() => btn.innerText = "Copy", 1500);
}
</script>

